{"version":3,"sources":["apiResponse.js","filters.js","FilteredOutput.js","index.js"],"names":["apiResponse","map","entry","node","forEach","key","htmlEntityDecode","split","message","FilterContextProvider","children","inputArray","useState","filterFunctionsArray","outputArray","state","setState","useEffect","filteredOutput","length","filterFunction","filter","item","function","console","log","FilterContext","Provider","value","React","createContext","BooleanFilter","parameterName","label","booleanState","setBooleanState","useContext","context","setContext","newFilterFunctionsArray","push","name","type","checked","onChange","MultiSelectFilter","validOptions","Set","optionName","add","optionsArray","option","selected","setSelected","overrideStrings","options","selectedOptions","selectedOptionValues","some","includes","hasSelectAll","disableSearch","FilteredOutput","results","title","String","online_event","sold_out","audience","join","topics","dangerouslySetInnerHTML","__html","nid","App","rootElement","document","getElementById","ReactDOM","render"],"mappings":"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","file":"static/js/main.ec4aff20.chunk.js","sourcesContent":["import {decode as htmlEntityDecode} from 'he'; // For rendering HTML entities inside description strings\n\nconst D7Output = {\n    \"nodes\": [{\n        \"node\": {\n            \"nid\": \"31439\",\n            \"title\": \"Filter Test Event\",\n            \"path\": \"/our-events/filter-test-event\",\n            \"start_date\": \"1607876100\",\n            \"end_date\": \"1608833700\",\n            \"sold_out\": \"0\",\n            \"online_event\": \"0\",\n            \"message\": \"\",\n            \"topics\": \"Amphibians &amp; Reptiles|Ancient Americas|Animals\",\n            \"audience\": \"Comma Test, Test, Test|Families|Adults\"\n        }\n    }, {\n        \"node\": {\n            \"nid\": \"31406\",\n            \"title\": \"Discovery Adventures: How do animals adapt to the cold?\",\n            \"path\": \"/our-events/discovery-adventures-how-do-animals-adapt-cold\",\n            \"start_date\": \"1608053400\",\n            \"end_date\": \"1608055200\",\n            \"sold_out\": \"0\",\n            \"online_event\": \"1\",\n            \"message\": \"<p>Tune into this free, online event to learn about the natural world with up close looks at Field Museum exhibitions, collections, and research.</p>\",\n            \"topics\": \"Animals\",\n            \"audience\": \"Families|Adults|Teens &amp; Pre-teens\"\n        }\n    }, {\n        \"node\": {\n            \"nid\": \"31413\",\n            \"title\": \"Discovery Adventures for Classrooms: How do animals adapt to the cold?\",\n            \"path\": \"/our-events/discovery-adventures-classrooms-how-do-animals-adapt-cold\",\n            \"start_date\": \"1608058800\",\n            \"end_date\": \"1608060600\",\n            \"sold_out\": \"0\",\n            \"online_event\": \"1\",\n            \"message\": \"<p>Students learn about the natural world in this free, online event with up-close looks at Field Museum exhibitions, collections, and research.</p>\",\n            \"topics\": \"Animals\",\n            \"audience\": \"Families|Teens &amp; Pre-teens|Educators\"\n        }\n    }, {\n        \"node\": {\n            \"nid\": \"31343\",\n            \"title\": \"SUE the T. rex Virtual Tour: Prehistoric Winter\",\n            \"path\": \"/our-events/sue-t-rex-virtual-tour-1\",\n            \"start_date\": \"1608154200\",\n            \"end_date\": \"1608157800\",\n            \"sold_out\": \"0\",\n            \"online_event\": \"0\",\n            \"message\": \"<p>Explore aspects of SUE's environment, including the temperature range they endured.</p>\",\n            \"topics\": null,\n            \"audience\": null\n        }\n    }, {\n        \"node\": {\n            \"nid\": \"31426\",\n            \"title\": \"SUE Science Saturdays: Prehistoric Party\",\n            \"path\": \"/our-events/sue-science-saturdays-prehistoric-party\",\n            \"start_date\": \"1611417600\",\n            \"end_date\": \"1611424800\",\n            \"sold_out\": \"0\",\n            \"online_event\": \"1\",\n            \"message\": \"<p>Families spend their Saturday morning online with Field scientists and SUE the T. rex for a hands-on look at the museum.</p>\",\n            \"topics\": \"Dinosaurs\",\n            \"audience\": \"Families\"\n        }\n    }, {\n        \"node\": {\n            \"nid\": \"31344\",\n            \"title\": \"SUE the T. rex Virtual Tour: Cretaceous Cupid\",\n            \"path\": \"/our-events/sue-t-rex-virtual-tour-2\",\n            \"start_date\": \"1612992600\",\n            \"end_date\": \"1612996200\",\n            \"sold_out\": \"0\",\n            \"online_event\": \"0\",\n            \"message\": \"<p>Uncover some of SUE's favorite treats. Then, learn about <em>T. rex</em> mating habits and gender determination.</p>\",\n            \"topics\": null,\n            \"audience\": null\n        }\n    }, {\n        \"node\": {\n            \"nid\": \"31427\",\n            \"title\": \"SUE Science Saturdays: Time Travelling Through the Midwest  \",\n            \"path\": \"/our-events/sue-science-saturdays-time-travelling-through-midwest\",\n            \"start_date\": \"1615651200\",\n            \"end_date\": \"1615658400\",\n            \"sold_out\": \"0\",\n            \"online_event\": \"1\",\n            \"message\": \"<p>Families spend their Saturday morning online with Field scientists and SUE the T. rex for a hands-on look at the museum.</p>\",\n            \"topics\": \"Dinosaurs\",\n            \"audience\": \"Families\"\n        }\n    }, {\n        \"node\": {\n            \"nid\": \"31345\",\n            \"title\": \"SUE the T. rex Virtual Tour: April Fools'\",\n            \"path\": \"/our-events/sue-t-rex-virtual-tour-3\",\n            \"start_date\": \"1617222600\",\n            \"end_date\": \"1617226200\",\n            \"sold_out\": \"0\",\n            \"online_event\": \"0\",\n            \"message\": \"<p>See how dinosaurs have stumped scientists\\u2014and what mysteries SUE helps solve.</p>\",\n            \"topics\": null,\n            \"audience\": null\n        }\n    }, {\n        \"node\": {\n            \"nid\": \"31428\",\n            \"title\": \"SUE Science Saturdays: Urban Ecology: The Wilder Side of the City    \",\n            \"path\": \"/our-events/sue-science-saturdays-urban-ecology-wilder-side-city\",\n            \"start_date\": \"1618671600\",\n            \"end_date\": \"1618678800\",\n            \"sold_out\": \"1\",\n            \"online_event\": \"1\",\n            \"message\": \"<p>Families spend their Saturday morning online with Field scientists and SUE the T. rex for a hands-on look at the museum.</p>\",\n            \"topics\": \"Dinosaurs\",\n            \"audience\": \"Families\"\n        }\n    }, {\n        \"node\": {\n            \"nid\": \"31346\",\n            \"title\": \"SUE the T. rex Virtual Tour: National Dinosaur Day\",\n            \"path\": \"/our-events/sue-t-rex-virtual-tour-national-dinosaur-day\",\n            \"start_date\": \"1622579400\",\n            \"end_date\": \"1622583000\",\n            \"sold_out\": \"1\",\n            \"online_event\": \"0\",\n            \"message\": \"<p>Celebrate <em>T. rex</em>&nbsp;and other famous dinosaurs that lived before and during SUE's time.</p>\",\n            \"topics\": null,\n            \"audience\": null\n        }\n    }], \"pager\": {\"pages\": 1, \"page\": 0, \"count\": 10, \"limit\": 12}\n};\n\nlet apiResponse = D7Output.nodes.map(entry => {\n\n    const node = entry.node;\n\n    // Typecast strings into arrays\n    ['audience','topics'].forEach(key => {\n        if(node[key]) {\n            node[key] = htmlEntityDecode(node[key]);\n            node[key] = node[key].split('|');\n        }\n    });\n\n    // Type strings into booleans\n    ['sold_out', 'online_event'].forEach(key =>\n    {\n        switch(node[key]) {\n            case true:\n            case 'true':\n            case '1':\n            case 1:\n                node[key] = true;\n                break;\n\n            default:\n                node[key] = false;\n        }\n    });\n\n    // Parse HTML entities from Drupal's output\n    if(node.message) {\n        node.message = htmlEntityDecode(node.message);\n    }\n\n    return node;\n});\n\nexport default apiResponse;","/* Context for sharing state across components */\nimport React, {useContext, useEffect, useState} from \"react\";\nimport MultiSelect from \"react-multi-select-component\";\n\nexport const FilterContextProvider = ({children, inputArray}) => {\n    const [state, setState] = useState({\n        inputArray: inputArray,\n        filterFunctionsArray: [],\n        outputArray: inputArray\n    });\n\n    useEffect(() => {\n        let filteredOutput = inputArray;\n\n        if (state.filterFunctionsArray.length) {\n            state.filterFunctionsArray.map(filterFunction => filteredOutput = filteredOutput.filter(item => filterFunction.function(item)));\n        }\n\n        setState({...state, outputArray: filteredOutput});\n\n        console.log('filterFunctionsArray', state.filterFunctionsArray);\n    }, [state.filterFunctionsArray]);\n    return (\n        <FilterContext.Provider value={[state, setState]}>\n            {children}\n        </FilterContext.Provider>\n    );\n};\n\nexport const FilterContext = React.createContext();\n\nexport const BooleanFilter = ({parameterName, label}) => {\n    const [booleanState, setBooleanState] = useState(false);\n    const booleanHandler = () => setBooleanState(!booleanState);\n\n    const [context, setContext] = useContext(FilterContext);\n    const filterFunction = (item) => item[parameterName] === booleanState;\n\n    useEffect(() => {\n\n        let newFilterFunctionsArray = context.filterFunctionsArray;\n\n        if (booleanState) {\n            // When the box is checked, we add a new filter function to the array\n            newFilterFunctionsArray.push({name: parameterName, function: filterFunction});\n        } else {\n            // When the box is unchecked, we want to REMOVE this filter from the array, so we filter it out\n            // We do this because (counter-intuitively), the box being unchecked does NOT mean we want to filter for `false\n            // Rather, we'd rather just remove the filter to show everything. The alternative would be a 3-state checkbox\n            newFilterFunctionsArray = newFilterFunctionsArray.filter(item => item.name !== parameterName);\n        }\n        setContext({...context, filterFunctionsArray: [...newFilterFunctionsArray]});\n    }, [booleanState]);\n\n\n    return (\n        <label>\n            <input\n                name={parameterName}\n                type=\"checkbox\"\n                checked={booleanState}\n                onChange={booleanHandler}\n            />\n            {label}\n        </label>\n    )\n}\n\nexport function MultiSelectFilter({parameterName, label}) {\n    const [context, setContext] = useContext(FilterContext);\n\n    const validOptions = new Set();\n    context.inputArray.forEach(item => {\n            if (item[parameterName]) {\n                item[parameterName].forEach(optionName =>\n                    validOptions.add(optionName)\n                )\n            }\n        }\n    );\n\n    const optionsArray = [];\n    validOptions.forEach(option => optionsArray.push({label: option, value: option}))\n\n    const [selected, setSelected] = useState([]);\n\n\n    // Now we use https://www.npmjs.com/package/react-multi-select-component to display the actual checkboxes\n    const overrideStrings = {\n        // \"allItemsAreSelected\": \"All items are selected.\",\n        // \"clearSearch\": \"Clear Search\",\n        // \"noOptions\": \"No options\",\n        // \"search\": \"Search\",\n        // \"selectAll\": \"Select All\",\n        \"selectSomeItems\": label\n    }\n\n\n    const onChangeHandler = (selectedOptions) => {\n        console.log('I am changing', selectedOptions);\n\n        const selectedOptionValues = selectedOptions.map(option => option.value);\n        console.log('selectedOptionValues', selectedOptionValues);\n        const filterFunction = (item) => item[parameterName] && item[parameterName].some(option => selectedOptionValues.includes(option));\n\n        let newFilterFunctionsArray = context.filterFunctionsArray.filter(item => item.name !== parameterName);\n        if (selectedOptionValues.length) {\n            newFilterFunctionsArray.push({name: parameterName, function: filterFunction});\n        }\n\n        setContext({...context, filterFunctionsArray: [...newFilterFunctionsArray]}); // Spread operator ensures a new array is made, rather than updating the reference (not caught by useEffect)\n        console.log('Modified context', context);\n        setSelected(selectedOptions);\n    }\n\n    return (\n        <MultiSelect\n            options={optionsArray}\n            value={selected}\n            onChange={onChangeHandler}\n            hasSelectAll={false}\n            disableSearch={true}\n            overrideStrings={overrideStrings}\n        />\n    );\n\n}","import {FilterContext} from \"./filters\";\nimport {useContext} from \"react\";\n\nconst FilteredOutput = () => {\n    const [context] = useContext(FilterContext);\n    const results = context.outputArray;\n    console.log('Display context', context);\n\n    return (\n        <>\n            <h1>Showing {results.length} event(s)</h1>\n            <ul>\n                {results.map(item => (\n                    <li key={item.nid}><h2>{item.title}</h2>\n                        <ul>\n                            <li>Online? {String(item.online_event)}</li>\n                            <li>Sold out? {String(item.sold_out)}</li>\n                            <li>Audiences: {item.audience && item.audience.join(', ')}</li>\n                            <li>Topics: {item.topics && item.topics.join(', ')}</li>\n                            <p dangerouslySetInnerHTML={{__html: item.message}}/>\n                        </ul>\n                    </li>\n                ))}\n            </ul>\n        </>\n    )\n}\n\nexport default FilteredOutput;","import ReactDOM from 'react-dom';\nimport './App.css';\nimport apiResponse from \"./apiResponse.js\";\nimport {FilterContextProvider, BooleanFilter, MultiSelectFilter} from \"./filters\";\nimport FilteredOutput from \"./FilteredOutput\"; // Parse and transform mock API response into an array\n\nfunction App() {\n\n    console.log('apiResponse', apiResponse);\n\n    return (\n        <FilterContextProvider inputArray={apiResponse}>\n            <BooleanFilter parameterName={'sold_out'} label={'Sold out'} />\n            <BooleanFilter parameterName={'online_event'} label={'Online'} />\n            <MultiSelectFilter parameterName={'audience'} label={'Audience'} />\n            <MultiSelectFilter parameterName={'topics'} label={'Topics'} />\n            <FilteredOutput />\n        </FilterContextProvider>\n    )\n}\n\nconst rootElement = document.getElementById(\"root\");\nReactDOM.render(<App/>, rootElement);"],"sourceRoot":""}