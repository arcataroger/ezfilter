{"version":3,"sources":["index.js","apiResponse.js"],"names":["options","filterKeys","enableSearch","events","map","v","node","parsed","App","useState","searchResults","setSearchResults","searchTerm","setSearchTerm","selectedAudiences","setSelectedAudiences","selectedTopics","setSelectedTopics","onlineOnly","setOnlineOnly","useEffect","filteredEvents","length","filter","event","some","audience","includes","value","topic","topics","Fuse","keys","search","result","item","online_event","className","type","placeholder","onChange","e","target","defaultValue","placeholderButtonLabel","isSearchable","name","checked","title","message","nid","forEach","key","uniqueAudiences","Set","split","add","audienceString","label","htmlEntityDecode","rootElement","document","getElementById","ReactDOM","render"],"mappings":"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","file":"static/js/main.b9322c64.chunk.js","sourcesContent":["import React, {useState, useEffect} from \"react\";\nimport ReactDOM from 'react-dom';\nimport {decode as htmlEntityDecode} from 'he'; // For rendering HTML entities inside description strings\nimport ReactMultiSelectCheckboxes from 'react-multiselect-checkboxes';\nimport Fuse from 'fuse.js'; // Fuzzy keyword search\nimport './App.css';\n\nimport apiResponse from \"./apiResponse.js\"; // Parse and transform mock API response into an array\n\n// Which keys do we want to filter by?\nconst options = {\n    filterKeys: ['audience', 'topics'],\n    enableSearch: true,\n};\n\n\nconst events = apiResponse.map(v => v.node);\n\nlet parsed=[];\noptions.filterKeys.forEach(key => {\n    let uniqueAudiences = new Set(); // To ensure uniqueness\n    events.forEach(event => {\n        if (event[key]) {\n            event[key].split('|').map(item => uniqueAudiences.add(item))\n        }\n    })\n\n    parsed[key] = [...uniqueAudiences].map(audienceString => {\n        const label = htmlEntityDecode(audienceString); // Some of the audience names are HTML encoded (ampersands, etc.)\n        return {label: label, value: audienceString} // The format expected by ReactMultiSelectCheckboxes\n    });\n})\n\n\nfunction App() {\n    const [searchResults, setSearchResults] = useState([]);\n\n    // Title & description keyword search\n    const [searchTerm, setSearchTerm] = useState(\"\");\n    const textSearch = e => {\n        setSearchTerm(e.target.value);\n    };\n\n    // Audiences\n    const [selectedAudiences, setSelectedAudiences] = useState([]);\n\n    // Topics\n    const [selectedTopics, setSelectedTopics] = useState([]);\n\n    // Online only\n    const [onlineOnly, setOnlineOnly] = useState(false);\n    const onlineOnlyHandler = () => setOnlineOnly(!onlineOnly);\n\n\n    // The filtering algorithm\n    useEffect(() => {\n            // We'll whittle down the events one filter at a time.\n            let filteredEvents = events;\n\n            // Filter audiences\n            if (selectedAudiences.length > 0) {\n                filteredEvents = filteredEvents.filter(event =>\n                    // Array.some returns true as soon as the condition matches one element of the array, then stops\n                    selectedAudiences.some(audience => {\n                        if (event.audience) {\n                            return event.audience.includes(audience.value);\n                        } else return false;\n                    })\n                )\n            }\n\n            // Filter topics\n            if (selectedTopics.length > 0) {\n                filteredEvents = filteredEvents.filter(event =>\n                    // Array.some returns true as soon as the condition matches one element of the array, then stops\n                    selectedTopics.some(topic => {\n                        if (event.topics) {\n                            return event.topics.includes(topic.value);\n                        } else return false;\n                    })\n                )\n            }\n\n            // Then do a fuzzy keyword match\n            if (searchTerm) {\n                const fuse = new Fuse(filteredEvents, {\n                    keys: ['title', 'message']\n                })\n\n                filteredEvents = fuse.search(searchTerm).map(result => result.item);\n            }\n\n            // Online events only\n            if (onlineOnly) filteredEvents = filteredEvents.filter(event => event.online_event === \"1\");\n\n            setSearchResults(filteredEvents);\n\n        }, [selectedAudiences, selectedTopics, searchTerm, onlineOnly]\n    );\n\n    return (\n        <div className=\"App\">\n            {\n                options.enableSearch && <input\n                type=\"text\"\n                placeholder=\"Search\"\n                value={searchTerm}\n                onChange={textSearch}\n            />\n            }\n\n\n            <ReactMultiSelectCheckboxes\n                defaultValue={selectedAudiences}\n                options={parsed['audience']}\n                onChange={setSelectedAudiences}\n                placeholderButtonLabel=\"Audiences\"\n                isSearchable={false}\n            />\n\n            <ReactMultiSelectCheckboxes\n                defaultValue={selectedTopics}\n                options={parsed['topics']}\n                onChange={setSelectedTopics}\n                placeholderButtonLabel=\"Topics\"\n                isSearchable={false}\n            />\n\n            <label>Online\n                <input\n                    name=\"onlineOnly\"\n                    type=\"checkbox\"\n                    checked={onlineOnly}\n                    onChange={onlineOnlyHandler}\n                />\n            </label>\n\n            <h1>Matching Events ({searchResults.length})</h1>\n            <ul>\n                {searchResults.map(item => (\n                    <li key={item.nid}> {item.title}\n                        <ul>\n                            <li>Online? {item.online_event === \"1\" ? 'Online' : 'No'}</li>\n                            <li>Audiences: {item.audience}</li>\n                            <li>Topics: {item.topics}</li>\n                            <li>Message: {item.message}</li>\n                        </ul>\n                    </li>\n                ))}\n            </ul>\n        </div>\n    );\n}\n\nconst rootElement = document.getElementById(\"root\");\nReactDOM.render(<App/>, rootElement);\n","const D7Output = {\n    \"nodes\": [{\n        \"node\": {\n            \"nid\": \"31439\",\n            \"title\": \"Filter Test Event\",\n            \"path\": \"/our-events/filter-test-event\",\n            \"start_date\": \"1607876100\",\n            \"end_date\": \"1608833700\",\n            \"sold_out\": \"0\",\n            \"online_event\": \"0\",\n            \"message\": \"\",\n            \"topics\": \"Amphibians &amp; Reptiles|Ancient Americas|Animals\",\n            \"audience\": \"Comma Test, Test, Test|Families|Adults\"\n        }\n    }, {\n        \"node\": {\n            \"nid\": \"31406\",\n            \"title\": \"Discovery Adventures: How do animals adapt to the cold?\",\n            \"path\": \"/our-events/discovery-adventures-how-do-animals-adapt-cold\",\n            \"start_date\": \"1608053400\",\n            \"end_date\": \"1608055200\",\n            \"sold_out\": \"0\",\n            \"online_event\": \"1\",\n            \"message\": \"<p>Tune into this free, online event to learn about the natural world with up close looks at Field Museum exhibitions, collections, and research.</p>\",\n            \"topics\": \"Animals\",\n            \"audience\": \"Families|Adults|Teens &amp; Pre-teens\"\n        }\n    }, {\n        \"node\": {\n            \"nid\": \"31413\",\n            \"title\": \"Discovery Adventures for Classrooms: How do animals adapt to the cold?\",\n            \"path\": \"/our-events/discovery-adventures-classrooms-how-do-animals-adapt-cold\",\n            \"start_date\": \"1608058800\",\n            \"end_date\": \"1608060600\",\n            \"sold_out\": \"0\",\n            \"online_event\": \"1\",\n            \"message\": \"<p>Students learn about the natural world in this free, online event with up-close looks at Field Museum exhibitions, collections, and research.</p>\",\n            \"topics\": \"Animals\",\n            \"audience\": \"Families|Teens &amp; Pre-teens|Educators\"\n        }\n    }, {\n        \"node\": {\n            \"nid\": \"31343\",\n            \"title\": \"SUE the T. rex Virtual Tour: Prehistoric Winter\",\n            \"path\": \"/our-events/sue-t-rex-virtual-tour-1\",\n            \"start_date\": \"1608154200\",\n            \"end_date\": \"1608157800\",\n            \"sold_out\": \"0\",\n            \"online_event\": \"0\",\n            \"message\": \"<p>Explore aspects of SUE's environment, including the temperature range they endured.</p>\",\n            \"topics\": null,\n            \"audience\": null\n        }\n    }, {\n        \"node\": {\n            \"nid\": \"31426\",\n            \"title\": \"SUE Science Saturdays: Prehistoric Party\",\n            \"path\": \"/our-events/sue-science-saturdays-prehistoric-party\",\n            \"start_date\": \"1611417600\",\n            \"end_date\": \"1611424800\",\n            \"sold_out\": \"0\",\n            \"online_event\": \"1\",\n            \"message\": \"<p>Families spend their Saturday morning online with Field scientists and SUE the T. rex for a hands-on look at the museum.</p>\",\n            \"topics\": \"Dinosaurs\",\n            \"audience\": \"Families\"\n        }\n    }, {\n        \"node\": {\n            \"nid\": \"31344\",\n            \"title\": \"SUE the T. rex Virtual Tour: Cretaceous Cupid\",\n            \"path\": \"/our-events/sue-t-rex-virtual-tour-2\",\n            \"start_date\": \"1612992600\",\n            \"end_date\": \"1612996200\",\n            \"sold_out\": \"0\",\n            \"online_event\": \"0\",\n            \"message\": \"<p>Uncover some of SUE's favorite treats. Then, learn about <em>T. rex</em> mating habits and gender determination.</p>\",\n            \"topics\": null,\n            \"audience\": null\n        }\n    }, {\n        \"node\": {\n            \"nid\": \"31427\",\n            \"title\": \"SUE Science Saturdays: Time Travelling Through the Midwest  \",\n            \"path\": \"/our-events/sue-science-saturdays-time-travelling-through-midwest\",\n            \"start_date\": \"1615651200\",\n            \"end_date\": \"1615658400\",\n            \"sold_out\": \"0\",\n            \"online_event\": \"1\",\n            \"message\": \"<p>Families spend their Saturday morning online with Field scientists and SUE the T. rex for a hands-on look at the museum.</p>\",\n            \"topics\": \"Dinosaurs\",\n            \"audience\": \"Families\"\n        }\n    }, {\n        \"node\": {\n            \"nid\": \"31345\",\n            \"title\": \"SUE the T. rex Virtual Tour: April Fools'\",\n            \"path\": \"/our-events/sue-t-rex-virtual-tour-3\",\n            \"start_date\": \"1617222600\",\n            \"end_date\": \"1617226200\",\n            \"sold_out\": \"0\",\n            \"online_event\": \"0\",\n            \"message\": \"<p>See how dinosaurs have stumped scientists\\u2014and what mysteries SUE helps solve.</p>\",\n            \"topics\": null,\n            \"audience\": null\n        }\n    }, {\n        \"node\": {\n            \"nid\": \"31428\",\n            \"title\": \"SUE Science Saturdays: Urban Ecology: The Wilder Side of the City    \",\n            \"path\": \"/our-events/sue-science-saturdays-urban-ecology-wilder-side-city\",\n            \"start_date\": \"1618671600\",\n            \"end_date\": \"1618678800\",\n            \"sold_out\": \"0\",\n            \"online_event\": \"1\",\n            \"message\": \"<p>Families spend their Saturday morning online with Field scientists and SUE the T. rex for a hands-on look at the museum.</p>\",\n            \"topics\": \"Dinosaurs\",\n            \"audience\": \"Families\"\n        }\n    }, {\n        \"node\": {\n            \"nid\": \"31346\",\n            \"title\": \"SUE the T. rex Virtual Tour: National Dinosaur Day\",\n            \"path\": \"/our-events/sue-t-rex-virtual-tour-national-dinosaur-day\",\n            \"start_date\": \"1622579400\",\n            \"end_date\": \"1622583000\",\n            \"sold_out\": \"0\",\n            \"online_event\": \"0\",\n            \"message\": \"<p>Celebrate <em>T. rex</em>&nbsp;and other famous dinosaurs that lived before and during SUE's time.</p>\",\n            \"topics\": null,\n            \"audience\": null\n        }\n    }], \"pager\": {\"pages\": 1, \"page\": 0, \"count\": 10, \"limit\": 12}\n};\n\nlet apiResponse = D7Output.nodes;\n\nexport default apiResponse;"],"sourceRoot":""}